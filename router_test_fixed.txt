ğŸ¬ Starting router_claude.js test script...

ğŸŒ PassiveBridgeNode initializing
ğŸŒ Creating WebSocketConnectionManager for nodejsâ†’browser
ğŸŒ Initialized Node.js WebSocket support
ğŸŒ WebSocket server listening on 127.0.0.1:8083
âš ï¸ Unable to confidently detect environment, defaulting to nodejs
ğŸ”— Setting up routing table connection event handlers...
ğŸ”— Attaching peerConnected event handler to server connection manager
ğŸŒ Initializing overlay network for WebRTC signaling...
ğŸ”— WebSocketConnectionManager initialized with node ID: 11088421a4f176af920c83cbc03e2bf7b2dda7cb
â³ Waiting for WebSocket initialization to complete...
ğŸŒ WebSocket server ready at ws://localhost:8083
ğŸŒ PassiveBridgeNode initializing
ğŸŒ Creating WebSocketConnectionManager for nodejsâ†’browser
âš ï¸ Unable to confidently detect environment, defaulting to nodejs
ğŸ”— Setting up routing table connection event handlers...
ğŸ”— Attaching peerConnected event handler to server connection manager
ğŸŒ Initialized Node.js WebSocket support
ğŸŒ Initializing overlay network for WebRTC signaling...
ğŸ”— WebSocketConnectionManager initialized with node ID: 6b72119445716745368c817175813cd287a045fc
â³ Waiting for WebSocket initialization to complete...
ğŸŒ WebSocket server ready at ws://localhost:8084
ğŸŒ WebSocket server listening on 127.0.0.1:8084
ğŸ”— Public server: 0.0.0.0:8080
ğŸŒ Open network mode: ENABLED (no invitations required)
âœ… Bootstrap server started on port 8080

ğŸŒ NodeDHTClient initializing
ğŸŒ Creating WebSocketConnectionManager for nodejsâ†’browser
ğŸŒ Initialized Node.js WebSocket support
ğŸŒ WebSocket server listening on 127.0.0.1:52948
âš ï¸ Unable to confidently detect environment, defaulting to nodejs
ğŸ”— Setting up routing table connection event handlers...
ğŸ”— Attaching peerConnected event handler to server connection manager
ğŸ”— New client connection (total: 1)
ğŸ”— Connecting to bridge node: localhost:8083
ğŸ”— Connecting to bridge node: localhost:8084
ğŸ”— Incoming WebSocket connection from 127.0.0.1
ğŸ”— Incoming WebSocket connection from 127.0.0.1
ğŸ”— Bootstrap server connected: bootstrap_1763346421802
ğŸ”— DHT received peerConnected: bootstra... (via WebSocketConnectionManager)
ğŸ”— Bootstrap server connection detected - skipping DHT operations for bootstrap_176334...
ğŸ”— Incoming connection from bootstra... via connection manager
ğŸ”— Bootstrap server connection established: bootstrap_1763346421802
ğŸ”— Bootstrap server connected: bootstrap_1763346421802
ğŸ”— DHT received peerConnected: bootstra... (via WebSocketConnectionManager)
ğŸ”— Bootstrap server connection detected - skipping DHT operations for bootstrap_176334...
ğŸ”— Incoming connection from bootstra... via connection manager
ğŸ”— Bootstrap server connection established: bootstrap_1763346421802
ğŸ” Validating disconnected peer 11088421: not in routing table yet
ğŸ”— Creating CLIENT connection manager for outgoing connection to 11088421...
âš ï¸ ConnectionManagerFactory creating NEW manager for 11088421... (no caching enabled)
ğŸŒ Creating WebSocketConnectionManager for nodejsâ†’nodejs
ğŸ”— WebSocketConnectionManager initialized with node ID: 8fd8ab88cafcaa61cfa7d90fe88bef58e3a01d50
ğŸ”— Event handler attached to WebSocketConnectionManager for 11088421
ğŸ” Validating disconnected peer 6b721194: not in routing table yet
ğŸ”— Creating CLIENT connection manager for outgoing connection to 6b721194...
âš ï¸ ConnectionManagerFactory creating NEW manager for 6b721194... (no caching enabled)
ğŸŒ Creating WebSocketConnectionManager for nodejsâ†’nodejs
ğŸ”— WebSocketConnectionManager initialized with node ID: 8fd8ab88cafcaa61cfa7d90fe88bef58e3a01d50
ğŸ”— Event handler attached to WebSocketConnectionManager for 6b721194
ğŸ”— Connecting to bridge node 11088421... at ws://localhost:8083
â³ Waiting for WebSocket initialization...
ğŸ”— Connecting to bridge node 6b721194... at ws://localhost:8084
â³ Waiting for WebSocket initialization...
ğŸ”— Connecting to bridge node 11088421... at ws://localhost:8083
â³ Waiting for WebSocket initialization...
ğŸ”— Connecting to bridge node 6b721194... at ws://localhost:8084
â³ Waiting for WebSocket initialization...
[DHT] ğŸ“ Storing key: public_key:8fd8ab88cafcaa61cfa7d90fe88bef58e3a01d50
ğŸ”— Skipping find_node query to non-connected node: 6b721194...
ğŸ”— Skipping find_node query to non-connected node: 11088421...
ğŸŒ Initialized Node.js WebSocket support
ğŸŒ Initialized Node.js WebSocket support
ğŸŒ Initializing overlay network for WebRTC signaling...
ğŸ”— WebSocket connection: nodejs â†’ bridge
ğŸŒ Creating WebSocket connection to 11088421... at ws://localhost:8083
ğŸ”— WebSocket connection: nodejs â†’ bridge
ğŸŒ Creating WebSocket connection to 6b721194... at ws://localhost:8084
ğŸ”— WebSocket connection: nodejs â†’ bridge
ğŸŒ Creating WebSocket connection to 11088421... at ws://localhost:8083
ğŸ”— WebSocket connection: nodejs â†’ bridge
ğŸŒ Creating WebSocket connection to 6b721194... at ws://localhost:8084
ğŸ”— Incoming WebSocket connection from 127.0.0.1
ğŸ”— Incoming WebSocket connection from 127.0.0.1
ğŸ”— Incoming WebSocket connection from 127.0.0.1
ğŸ”— Incoming WebSocket connection from 127.0.0.1
âš ï¸ Server manager already handling bootstra, ignoring setup for 8fd8ab88 (should have own manager)
âš ï¸ Server manager already handling bootstra, ignoring setup for 8fd8ab88 (should have own manager)
âš ï¸ Server manager already handling bootstra, ignoring setup for 8fd8ab88 (should have own manager)
âš ï¸ Server manager already handling bootstra, ignoring setup for 8fd8ab88 (should have own manager)
ğŸ”— DHT received peerConnected: 11088421... (via WebSocketConnectionManager)
ğŸ”„ Node 11088421... already exists in routing table
ğŸ”— Setting up connection for existing node 11088421...
ğŸ”— DHT received peerConnected: 6b721194... (via WebSocketConnectionManager)
ğŸ”„ Node 6b721194... already exists in routing table
ğŸ”— Setting up connection for existing node 6b721194...
ğŸ”— DHT received peerConnected: 11088421... (via WebSocketConnectionManager)
ğŸ”„ Node 11088421... already exists in routing table
ğŸ”— DHT received peerConnected: 6b721194... (via WebSocketConnectionManager)
ğŸ”„ Node 6b721194... already exists in routing table
ğŸŒ NodeDHTClient initializing
ğŸŒ Creating WebSocketConnectionManager for nodejsâ†’browser
ğŸŒ Initialized Node.js WebSocket support
ğŸŒ WebSocket server listening on 127.0.0.1:52963
âš ï¸ Unable to confidently detect environment, defaulting to nodejs
ğŸ”— Setting up routing table connection event handlers...
ğŸ”— Attaching peerConnected event handler to server connection manager
ğŸ”— New client connection (total: 2)
ğŸŒ Open network mode: Finding random onboarding peer for f069d5ad...
ğŸ”„ Checking stale buckets: 2 connected, 2 routing
ğŸ”„ Checking stale buckets: 2 connected, 2 routing
ğŸ”„ Checking stale buckets: 2 connected, 2 routing
ğŸ”— Connecting to bridge node: localhost:8083
ğŸ”— Connecting to bridge node: localhost:8084
ğŸ”— Incoming WebSocket connection from 127.0.0.1
ğŸ”— Incoming WebSocket connection from 127.0.0.1
ğŸ”— Bootstrap server connected: bootstrap_1763346422968
âš ï¸ Server manager already handling bootstra, ignoring setup for bootstra (should have own manager)
ğŸ”— Bootstrap server connected: bootstrap_1763346422968
âš ï¸ Server manager already handling bootstra, ignoring setup for bootstra (should have own manager)
Failed to send message to bootstrap_1763346422968: Error: Manager is for bootstrap_1763346421802, cannot send to bootstrap_1763346422968
    at WebSocketConnectionManager.sendRawMessage (file:///C:/git/yz.network/src/network/WebSocketConnectionManager.js:569:13)
    at WebSocketConnectionManager.sendMessage (file:///C:/git/yz.network/src/network/ConnectionManager.js:112:18)
    at PassiveBridgeNode.handleBootstrapAuth (file:///C:/git/yz.network/src/bridge/PassiveBridgeNode.js:924:36)
    at PassiveBridgeNode.handleConnectionMessage (file:///C:/git/yz.network/src/bridge/PassiveBridgeNode.js:894:12)
    at WebSocketConnectionManager.<anonymous> (file:///C:/git/yz.network/src/bridge/PassiveBridgeNode.js:146:12)
    at WebSocketConnectionManager.emit (node:events:518:28)
    at WebSocketConnectionManager.handleMessage (file:///C:/git/yz.network/src/network/ConnectionManager.js:202:16)
    at Timeout._onTimeout (file:///C:/git/yz.network/src/network/WebSocketConnectionManager.js:194:18)
    at listOnTimeout (node:internal/timers:594:17)
    at process.processTimers (node:internal/timers:529:7)
node:internal/process/promises:394
    triggerUncaughtException(err, true /* fromPromise */);
    ^

Error: Manager is for bootstrap_1763346421802, cannot send to bootstrap_1763346422968
    at WebSocketConnectionManager.sendRawMessage (file:///C:/git/yz.network/src/network/WebSocketConnectionManager.js:569:13)
    at WebSocketConnectionManager.sendMessage (file:///C:/git/yz.network/src/network/ConnectionManager.js:112:18)
    at PassiveBridgeNode.handleBootstrapAuth (file:///C:/git/yz.network/src/bridge/PassiveBridgeNode.js:924:36)
    at PassiveBridgeNode.handleConnectionMessage (file:///C:/git/yz.network/src/bridge/PassiveBridgeNode.js:894:12)
    at WebSocketConnectionManager.<anonymous> (file:///C:/git/yz.network/src/bridge/PassiveBridgeNode.js:146:12)
    at WebSocketConnectionManager.emit (node:events:518:28)
    at WebSocketConnectionManager.handleMessage (file:///C:/git/yz.network/src/network/ConnectionManager.js:202:16)
    at Timeout._onTimeout (file:///C:/git/yz.network/src/network/WebSocketConnectionManager.js:194:18)
    at listOnTimeout (node:internal/timers:594:17)
    at process.processTimers (node:internal/timers:529:7)

Node.js v22.14.0
